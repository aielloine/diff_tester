jQuery(document).ready(function(a){fk_selects=[];fk_select=function(b){var c=this;c.type="select";c.$select=b;c.remove_index=0;c.number=Math.floor(Math.random()*50)*new Date().getUTCMilliseconds();c.label=c.$select.attr("data-placeholder");c.open={bool:false,html_class:"close"};c.selected={value:c.$select.find("option[selected]").val(),string:c.$select.find("option[selected]").text(),lenght:c.$select.find("option[selected]").length,html_class:"unselected"};c.required={bool:c.$select.hasClass("required"),message:"aucun"};c.disabled=c.$select.prop("disabled");c.search=c.$select.hasClass("search");if(c.selected.value==undefined){c.selected.value=null}if(c.selected.lenght>0){c.selected.html_class="selected"}else{c.selected.string=" "}c.options={$options:[],options:[]};if(c.$select.find("option").length<5){c.search=false}if(c.$select.prop("multiple")){c.type="multiple_select";c.selected.value=[];c.$select.find("option[selected]").each(function(){c.selected.value.push(a(this))});if(c.selected.lenght){c.selected.string=c.selected.lenght+" selectionées"}}fk_selects.push(c);c.init();c.set_placeholder_dimensions()};fk_select.prototype={utils:{copy_attr:function(b,c){if(b==undefined){return""}return b.split(" ").map(function(d){return d+"_"+c+"_fk "}).join("")},get_wrapper_class:function(c){var b=c.$select.attr("class");c.$select.attr("class","");return"fk_"+c.type+"-wrapper "+b+" "+c.selected.html_class+" fk_global-select "+c.open.html_class},get_wrapper_id:function(c){var b=c.utils.copy_attr(c.$select.attr("id"),"select");return"fk_"+c.type+"_"+c.number+" "+b}},init:function(){var g=this;var e=a("<div/>",{"class":"fk_"+g.type});var d=a("<label/>",{html:g.label,"class":"placeholder"});var b=a("<span/>",{"class":"select_trigger",html:g.selected.string});var c=a("<div/>",{"class":"options"});var f=a("<div/>",{"class":g.utils.get_wrapper_class(g),id:g.utils.get_wrapper_id(g)});if(g.disabled){f.addClass("disabled")}if(g.search){_search_input=a("<input/>",{"class":"fk search_input",type:"search"});_shearch_wrapper=a("<div/>",{"class":"option no_value no_selectable no_close search_wrapper"});g.remove_index--;g.options.options.push(_search_input.wrap(_shearch_wrapper).parent().appendTo(c))}if(!g.required.bool&&g.type!="multiple_select"){g.options.options.push(a("<div/>",{"class":"option no_options no_value ",html:g.required.message,style:"text-align:center; color: var(--gray)"}).appendTo(c));g.remove_index--}a.each(g.$select.find("option"),function(h,i){var i=a(this);var j=g.utils.copy_attr(i.attr("class"),"option");var k=g.utils.copy_attr(i.attr("id"),"option");g.options.$options.push(i.addClass("value_"+(h+1)));g.options.options.push(a("<div/>",{"class":"option value_"+(h+1)+" "+j,id:k,"data-value":i.val(),html:g.get_option(i)}).appendTo(c))});g.options.html_structure=c;g.fk_select=g.$select.wrap(f).parent().append(e.append(d,b,c));g.elements={fk_select:e,label:d,select_trigger:b,options:c,wrapper:f,};if(g.search){g.elements.search_input=_search_input}g.events()},get_option:function(e){var f=this;var d=e.html();var b=a("<span/>",{"class":"text",html:d});if(f.type=="multiple_select"){value_x="";e.attr("class").replace(/\b(value_)(.+)\b/,function(g){value_x=g});var c=a("<input/>",{type:"checkbox","class":"fk",checked:e.prop("selected"),id:value_x+"_"+f.number});b=a.merge(c,b)}return b},open_select:function(){var b=this;b.open.bool=true;b.fk_select.removeClass("close");b.open.html_class="open";b.fk_select.addClass(b.open.html_class);if(b.search){b.elements.search_input.focus()}},close_selects:function(){var b=this;a.each(fk_selects,function(c,d){d.fk_select.removeClass("open");d.open.html_class="close";d.fk_select.addClass(d.open.html_class);d.open.bool=false})},events:function(){var b=this;a.each(b.options.options,function(c,d){a(this).on("click",function(f){var h=c;var e=a(f.target);if(e.parents(".no_options")[0]!=undefined||e.hasClass("no_options")){b.delete_selected_options()}if(e.parents(".no_value")[0]!=undefined||e.hasClass("no_value")){return}if(e.is("label")){return}if(e.is(':not("input, label")')){var g=b.options.options[h].find("input[type=checkbox]");g.prop("checked",!g.prop("checked"))}b.change_option(h)})});b.fk_select.on("click",function(e){var c=b.open.bool;var d=a(e.target);if(d.parents(".no_close")[0]!=undefined||d.hasClass("no_close")){e.stopPropagation();return}b.close_selects();if(b.disabled){return}a(document).on("click",function(f){b.close_selects()});if(!c||a(e.target).parents(".options")[0]!=undefined&&b.type=="multiple_select"){b.open_select(e)}e.stopPropagation()});if(b.search){b.elements.search_input.on("keyup",function(d){var c=a(d.target);a.each(b.options.options,function(f,g){var h=g;var e=h.find(".text").text().toLowerCase().indexOf(c.val().toLowerCase());if(!h.hasClass("no_value")&&e>=0){h.show()}else{if(!h.hasClass("no_value")&&e<0){h.hide()}}})})}},change_option:function(c){var g=this;var f=c;var d=g.selected.value;g.options.$options[f+g.remove_index].prop("selected",true);if(g.type=="select"){d=g.options.options[f];g.selected.string=d.text();g.selected.lenght=d.length}if(g.type=="multiple_select"){selected_option=g.options.options[f];if(g.options.options[f].find("input[type=checkbox]").prop("checked")){d.push(selected_option);g.selected.lenght++}else{d.splice(a.inArray(selected_option,d),1);g.selected.lenght--;g.options.$options[f].prop("selected",false)}g.selected.string="";if(g.selected.lenght>0){g.selected.string=g.selected.lenght+" selectionées"}}if(g.selected.lenght>0){g.selected.html_class="selected";g.fk_select.addClass("selected");g.fk_select.removeClass("unselected")}else{g.selected.html_class="unselected";g.fk_select.addClass("unselected");g.fk_select.removeClass("selected")}var e=g.$select.get(0);var b=document.createEvent("HTMLEvents");b.initEvent("change",true,true);e.dispatchEvent(b);g.elements.select_trigger.html(g.selected.string)},delete_selected_options:function(){var b=this;b.selected.value=null;a.each(b.options.$options,function(c,d){a(this).prop("selected",false)});if(b.type=="select"){b.selected.string=" ";b.selected.lenght=0}b.selected.html_class="unselected";b.fk_select.addClass("unselected");b.fk_select.removeClass("selected");b.elements.select_trigger.html(b.selected.string)},set_placeholder_dimensions:function(){var e=this;var d=e.elements.select_trigger.html();e.elements.select_trigger.html(e.label);var c=e.elements.fk_select.width();var b=e.elements.fk_select.height();e.elements.select_trigger.html(d);e.elements.select_trigger.css({minWidth:c,minHeight:b});e.elements.options.css("top",b)}}});